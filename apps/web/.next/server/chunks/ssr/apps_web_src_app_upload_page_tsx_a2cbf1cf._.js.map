{"version":3,"sources":["../../../../../../apps/web/src/app/upload/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, FormEvent, ChangeEvent, DragEvent } from 'react';\nimport { useCategories } from '@johnny/api';\nimport { useUploadMusic } from '@johnny/api';\nimport { useQueryClient } from '@tanstack/react-query';\n\ninterface FileMetadata {\n  title: string;\n  titleZh: string;\n}\n\nexport default function UploadPage() {\n  // Batch upload state\n  const [files, setFiles] = useState<File[]>([]);\n  const [filesMetadata, setFilesMetadata] = useState<Record<string, FileMetadata>>({});\n\n  // Common metadata state\n  const [artist, setArtist] = useState<string>('');\n  const [artistZh, setArtistZh] = useState<string>('');\n  const [performer, setPerformer] = useState<string>('');\n  const [category, setCategory] = useState<string>('');\n  const [categoryZh, setCategoryZh] = useState<string>('');\n  const [newCategory, setNewCategory] = useState<string>('');\n  const [series, setSeries] = useState<string>('');\n  const [seriesZh, setSeriesZh] = useState<string>('');\n  const [newSeries, setNewSeries] = useState<string>('');\n  const [newArtist, setNewArtist] = useState<string>('');\n\n  const [submissionMessage, setSubmissionMessage] = useState<string>('');\n  const [isSubmitting, setIsSubmitting] = useState<boolean>(false);\n  const [isDragging, setIsDragging] = useState<boolean>(false);\n  const [uploadProgress, setUploadProgress] = useState<string>('');\n\n  const uploadEnabled = process.env.NEXT_PUBLIC_UPLOAD_ENABLED === 'true';\n\n  const { config, loading: categoriesLoading } = useCategories();\n  const categories = config.categories || [];\n  const musicians = config.musicians || [];\n  const seriesList = config.series || [];\n  const uploadMusicMutation = useUploadMusic();\n  const queryClient = useQueryClient();\n\n  useEffect(() => {\n    if (categories.length > 0 && !category) {\n      setCategory(categories[0].en);\n    }\n  }, [categories, category]);\n\n  useEffect(() => {\n    if (musicians.length > 0 && !artist) {\n      setArtist(musicians[0].en);\n      setArtistZh(musicians[0].zh);\n    }\n  }, [musicians, artist]);\n\n  if (!uploadEnabled) {\n    return (\n      <div className=\"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col justify-center items-center p-4\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Not Found</h1>\n        <p className=\"text-gray-600 dark:text-gray-400\">This page is not available in the current environment.</p>\n      </div>\n    );\n  }\n\n  const handleFileSelection = (selectedFiles: FileList | File[]) => {\n    const newFiles: File[] = [];\n    const newMetadata: Record<string, FileMetadata> = { ...filesMetadata };\n    const fileList = selectedFiles instanceof FileList ? Array.from(selectedFiles) : selectedFiles;\n\n    for (const file of fileList) {\n      if (file.size > 50 * 1024 * 1024) {\n        alert(`文件 ${file.name} 大小不能超过50MB`);\n        continue;\n      }\n      // Check if file already exists in current list to avoid duplicates if needed,\n      // but for now let's allow adding more.\n      // Actually, standard input behavior replaces. Let's append if checking, or replace if simpler.\n      // The prompt implies \"batch upload\", usually means adding multiple.\n      // Let's go with appending newly selected files to existing list.\n\n      const isDuplicate = files.some(f => f.name === file.name && f.size === file.size);\n      if (!isDuplicate) {\n        newFiles.push(file);\n        const nameWithoutExt = file.name.replace(/\\.mp3$/, '');\n        // Use a unique key for metadata, usually filename is enough for simple usage\n        // but if user uploads same file twice it might be tricky.\n        // Let's assume filename is unique enough for this session context.\n        newMetadata[file.name] = {\n          title: nameWithoutExt,\n          titleZh: nameWithoutExt,\n        };\n      }\n    }\n\n    setFiles(prev => [...prev, ...newFiles]);\n    setFilesMetadata(newMetadata);\n  };\n\n  const removeFile = (fileName: string) => {\n    setFiles(prev => prev.filter(f => f.name !== fileName));\n    const newMeta = { ...filesMetadata };\n    delete newMeta[fileName];\n    setFilesMetadata(newMeta);\n  };\n\n  const updateFileMetadata = (fileName: string, field: keyof FileMetadata, value: string) => {\n    setFilesMetadata(prev => ({\n      ...prev,\n      [fileName]: {\n        ...prev[fileName],\n        [field]: value,\n      },\n    }));\n  };\n\n  const handleFileChange = (e: ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files.length > 0) {\n      handleFileSelection(e.target.files);\n    }\n    // Reset input value so same files can be selected again if needed (though we handle duplicates check)\n    e.target.value = '';\n  };\n\n  const handleDragOver = (e: DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = (e: DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n  };\n\n  const handleDrop = (e: DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n      handleFileSelection(e.dataTransfer.files);\n    }\n  };\n\n  const handleCategoryChange = (e: ChangeEvent<HTMLSelectElement>) => {\n    const selectedEn = e.target.value;\n    setCategory(selectedEn);\n    if (selectedEn === '__NEW__') {\n      setCategoryZh('');\n      setNewCategory('');\n    }\n  };\n\n  const handleAddCategory = () => {\n    if (newCategory) {\n      setCategory(newCategory);\n      setNewCategory('');\n    }\n  };\n\n  const handleArtistChange = (e: ChangeEvent<HTMLSelectElement>) => {\n    const selectedEn = e.target.value;\n    setArtist(selectedEn);\n    if (selectedEn === '__NEW__') {\n      setArtistZh('');\n      setNewArtist('');\n    } else {\n      const selected = musicians.find(m => m.en === selectedEn);\n      if (selected) {\n        setArtistZh(selected.zh);\n      }\n    }\n  };\n\n  const handleAddArtist = () => {\n    if (newArtist) {\n      setArtist(newArtist);\n      setNewArtist('');\n    }\n  };\n\n  const handleSeriesChange = (e: ChangeEvent<HTMLSelectElement>) => {\n    const selectedEn = e.target.value;\n    setSeries(selectedEn);\n    if (selectedEn === '__NEW__') {\n      setSeriesZh('');\n      setNewSeries('');\n    } else {\n      const selected = seriesList.find(s => s.en === selectedEn);\n      if (selected) {\n        setSeriesZh(selected.zh);\n      } else {\n        if (selectedEn === '') setSeriesZh('');\n      }\n    }\n  };\n\n  const handleAddSeries = () => {\n    if (newSeries) {\n      setSeries(newSeries);\n      setNewSeries('');\n    }\n  };\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    if (files.length === 0) {\n      alert('请选择至少一个要上传的MP3文件。');\n      return;\n    }\n\n    setIsSubmitting(true);\n    setSubmissionMessage('准备上传...');\n    let successCount = 0;\n    let failCount = 0;\n\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        const meta = filesMetadata[file.name] || { title: file.name.replace(/\\.mp3$/, ''), titleZh: '' };\n\n        setUploadProgress(`正在上传 (${i + 1}/${files.length}): ${file.name}`);\n\n        try {\n          await uploadMusicMutation.mutateAsync({\n            file,\n            musicInfo: {\n              title: meta.title,\n              title_zh: meta.titleZh,\n              artist: artist === '__NEW__' ? newArtist : artist,\n              artist_zh: artist === '__NEW__' ? artistZh : (musicians.find(m => m.en === artist)?.zh || artistZh),\n              performer,\n              category: category === '__NEW__' ? newCategory : category,\n              category_zh: categoryZh,\n              series: series === '__NEW__' ? newSeries : series,\n              series_zh: series === '__NEW__' ? seriesZh : (seriesList.find(s => s.en === series)?.zh || seriesZh),\n              id: crypto.randomUUID(),\n            },\n          });\n          successCount++;\n        } catch (error) {\n          console.error(`Failed to upload ${file.name}:`, error);\n          failCount++;\n        }\n      }\n\n      queryClient.invalidateQueries({ queryKey: ['music'] });\n\n      if (failCount === 0) {\n        setSubmissionMessage(`全部 ${successCount} 个文件上传成功！`);\n        setFiles([]);\n        setFilesMetadata({});\n      } else {\n        setSubmissionMessage(`上传完成: ${successCount} 成功, ${failCount} 失败。`);\n      }\n\n      // Reset common fields if desired, or keep them for next batch?\n      // Keeping them is usually better for batch operations. \n      // User only asked for batch operation, usually implies reusing common data.\n      setTimeout(() => {\n        if (failCount === 0) setSubmissionMessage('');\n        setUploadProgress('');\n      }, 3000);\n\n    } catch (error: unknown) {\n      console.error('Batch submission error:', error);\n      const message = error instanceof Error ? error.message : '发生网络错误。';\n      setSubmissionMessage(`上传过程发生错误: ${message}`);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col justify-center items-center p-4\">\n      <div className=\"max-w-4xl w-full bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg\">\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 text-center\">批量上传音乐</h1>\n\n        {submissionMessage && (\n          <div className={`mb-4 p-4 text-sm rounded-lg ${submissionMessage.includes('失败') || submissionMessage.includes('错误') ? 'text-red-700 bg-red-100 dark:bg-red-200 dark:text-red-800' : 'text-green-700 bg-green-100 dark:bg-green-200 dark:text-green-800'}`} role=\"alert\">\n            <span className=\"font-medium\">{submissionMessage}</span>\n          </div>\n        )}\n\n        {uploadProgress && (\n          <div className=\"mb-4 p-2 text-sm text-blue-700 bg-blue-100 dark:bg-blue-900 dark:text-blue-200 rounded-lg text-center\">\n            {uploadProgress}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n\n          {/* File Upload Area */}\n          <div>\n            <label htmlFor=\"file-upload\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              MP3 文件 (支持多选)\n            </label>\n            <div\n              className={`mt-1 flex justify-center px-6 pt-5 pb-6 border-2 ${isDragging ? 'border-indigo-500' : 'border-gray-300 dark:border-gray-600'} border-dashed rounded-md`}\n              onDragOver={handleDragOver}\n              onDragLeave={handleDragLeave}\n              onDrop={handleDrop}\n            >\n              <div className=\"space-y-1 text-center\">\n                <svg className=\"mx-auto h-12 w-12 text-gray-400\" stroke=\"currentColor\" fill=\"none\" viewBox=\"0 0 48 48\" aria-hidden=\"true\">\n                  <path d=\"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                </svg>\n                <div className=\"flex text-sm text-gray-600 dark:text-gray-400 justify-center\">\n                  <label htmlFor=\"file-upload\" className=\"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500\">\n                    <span>选择文件</span>\n                    <input id=\"file-upload\" name=\"file-upload\" type=\"file\" className=\"sr-only\" accept=\".mp3\" multiple onChange={handleFileChange} disabled={isSubmitting} />\n                  </label>\n                  <p className=\"pl-1\">或拖放文件</p>\n                </div>\n                <p className=\"text-xs text-gray-500 dark:text-gray-400\">单文件 MP3 小于 50MB</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Selected Files List */}\n          {files.length > 0 && (\n            <div className=\"space-y-4 max-h-96 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded-md\">\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 sticky top-0 bg-white dark:bg-gray-800 pb-2 border-b border-gray-200 dark:border-gray-700\">\n                已选择 {files.length} 个文件\n              </h3>\n              {files.map((file, index) => (\n                <div key={`${file.name}-${index}`} className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg relative\">\n                  <button\n                    type=\"button\"\n                    onClick={() => removeFile(file.name)}\n                    className=\"absolute top-2 right-2 text-red-500 hover:text-red-700 text-sm\"\n                    disabled={isSubmitting}\n                  >\n                    删除\n                  </button>\n                  <div className=\"mb-2 text-sm text-gray-500 dark:text-gray-400 font-mono break-all pr-8\">\n                    {file.name} ({Math.round(file.size / 1024 / 1024 * 100) / 100} MB)\n                  </div>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">Name (English)</label>\n                      <input\n                        type=\"text\"\n                        value={filesMetadata[file.name]?.title || ''}\n                        onChange={(e) => updateFileMetadata(file.name, 'title', e.target.value)}\n                        disabled={isSubmitting}\n                        className=\"mt-1 block w-full px-2 py-1 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-sm shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm text-gray-900 dark:text-gray-100\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">名称 (中文)</label>\n                      <input\n                        type=\"text\"\n                        value={filesMetadata[file.name]?.titleZh || ''}\n                        onChange={(e) => updateFileMetadata(file.name, 'titleZh', e.target.value)}\n                        disabled={isSubmitting}\n                        className=\"mt-1 block w-full px-2 py-1 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-sm shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm text-gray-900 dark:text-gray-100\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Common Metadata */}\n          <div className=\"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg border border-gray-200 dark:border-gray-700\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4\">公共属性 (应用于所有文件)</h3>\n\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <label htmlFor=\"artist\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Musician / Composer (English)</label>\n                <select id=\"artist\" value={artist} onChange={handleArtistChange} disabled={isSubmitting || categoriesLoading} className=\"block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\">\n                  {musicians.map((m) => (<option key={m.id} value={m.en}>{m.en}</option>))}\n                  <option value=\"__NEW__\">Add New...</option>\n                </select>\n                {artist === '__NEW__' && (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n                    <input type=\"text\" value={newArtist} onChange={(e) => setNewArtist(e.target.value)} placeholder=\"New Musician (EN)\" disabled={isSubmitting} className=\"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n                    <div className=\"flex space-x-2\">\n                      <input type=\"text\" id=\"artistZh\" value={artistZh} onChange={(e) => setArtistZh(e.target.value)} placeholder=\"音乐家 (中文)\" disabled={isSubmitting} className=\"flex-1 px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n                      <button type=\"button\" onClick={handleAddArtist} disabled={isSubmitting} className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 whitespace-nowrap\">Add</button>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div>\n                <label htmlFor=\"performer\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Performer / 演奏者</label>\n                <input type=\"text\" id=\"performer\" value={performer} onChange={(e) => setPerformer(e.target.value)} disabled={isSubmitting} className=\"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n              </div>\n\n              <div>\n                <label htmlFor=\"category\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Category (English)</label>\n                <select id=\"category\" value={category} onChange={handleCategoryChange} disabled={isSubmitting || categoriesLoading} className=\"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\">\n                  {categories.map((cat) => (<option key={cat.id} value={cat.en}>{cat.en}</option>))}\n                  <option value=\"__NEW__\">Add New...</option>\n                </select>\n                {category === '__NEW__' && (\n                  <div className=\"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2\">\n                    <input type=\"text\" value={newCategory} onChange={(e) => setNewCategory(e.target.value)} placeholder=\"New Category (EN)\" disabled={isSubmitting} className=\"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n                    <div className=\"flex space-x-2\">\n                      <input type=\"text\" value={categoryZh} onChange={(e) => setCategoryZh(e.target.value)} placeholder=\"新分类 (中文)\" disabled={isSubmitting} className=\"flex-1 px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n                      <button type=\"button\" onClick={handleAddCategory} disabled={isSubmitting} className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 whitespace-nowrap\">Add</button>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"series\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Series (English)</label>\n                <select id=\"series\" value={series} onChange={handleSeriesChange} disabled={isSubmitting || categoriesLoading} className=\"block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\">\n                  <option value=\"\">None / Optional</option>\n                  {seriesList.map((s) => (<option key={s.id} value={s.en}>{s.en}</option>))}\n                  <option value=\"__NEW__\">Add New...</option>\n                </select>\n                {series === '__NEW__' && (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n                    <input type=\"text\" value={newSeries} onChange={(e) => setNewSeries(e.target.value)} placeholder=\"New Series (EN)\" disabled={isSubmitting} className=\"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n                    <div className=\"flex space-x-2\">\n                      <input type=\"text\" id=\"seriesZh\" value={seriesZh} onChange={(e) => setSeriesZh(e.target.value)} placeholder=\"系列 (中文)\" disabled={isSubmitting} className=\"flex-1 px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-gray-900 dark:text-gray-100\" />\n                      <button type=\"button\" onClick={handleAddSeries} disabled={isSubmitting} className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 whitespace-nowrap\">Add</button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <button type=\"submit\" disabled={isSubmitting || files.length === 0} className=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed\">\n              {isSubmitting ? '正在提交...' : `提交 (${files.length} 个文件)`}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}